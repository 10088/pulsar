<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>SNI 路由代理支持 · Apache Pulsar</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## 使用 SNI 路由的 Pulsar Proxy"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="SNI 路由代理支持 · Apache Pulsar"/><meta property="og:type" content="website"/><meta property="og:url" content="https://pulsar.incubator.apache.org/"/><meta property="og:description" content="## 使用 SNI 路由的 Pulsar Proxy"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://pulsar.incubator.apache.org/img/pulsar.svg"/><link rel="shortcut icon" href="/img/pulsar.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://pulsar.incubator.apache.org/blog/atom.xml" title="Apache Pulsar Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://pulsar.incubator.apache.org/blog/feed.xml" title="Apache Pulsar Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-102219959-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/custom.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-CN"><img class="logo" src="/img/pulsar.svg" alt="Apache Pulsar"/></a><a href="/zh-CN/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/zh-CN/next/standalone" target="_self">文档</a></li><li class=""><a href="/zh-CN/download" target="_self">下载</a></li><li class=""><a href="/docs/zh-CN/next/client-libraries" target="_self">客户端</a></li><li class=""><a href="#restapis" target="_self">REST API</a></li><li class=""><a href="#cli" target="_self">Cli</a></li><li class=""><a href="/blog/" target="_self">博客</a></li><li class=""><a href="#community" target="_self">社区</a></li><li class=""><a href="#apache" target="_self">Apache</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/next/concepts-proxy-sni-routing">English</a></li><li><a href="/docs/ja/next/concepts-proxy-sni-routing">日本語</a></li><li><a href="/docs/fr/next/concepts-proxy-sni-routing">Français</a></li><li><a href="/docs/ko/next/concepts-proxy-sni-routing">한국어</a></li><li><a href="/docs/zh-TW/next/concepts-proxy-sni-routing">繁體中文</a></li><li><a href="https://crowdin.com/project/apache-pulsar" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/apache-pulsar/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 id="__docusaurus" class="postHeaderTitle">SNI 路由代理支持</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="使用-sni-路由的-pulsar-proxy"></a><a href="#使用-sni-路由的-pulsar-proxy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 SNI 路由的 Pulsar Proxy</h2>
<p>代理服务器是一个中转服务，它通过网络转发多个客户端的请求到不同的后端服务器上。 代理服务器在正向代理和反向代理的场景中类似“流量检查”的作用。它能给你的系统带来如下好处，如父子啊均衡，性能，安全，自动扩缩容等等。</p>
<p>Pulsar Proxy 起到了反向代理的作用，它在所有的 broker 前面创建了一个网关。 Pulsar 是不支持Apache Traffic Server (ATS), HAProxy, Nginx和Envoy 等开源的代理组件的。 代理服务器支持<strong>SNI 路由</strong> SNI 路由用于在不断开 SSL 连接的情况下将流量转发到目的地。 四层路由转发提供了更大的透明度，因为转发的出口连接是根据TCP包里面携带的目标地址信息来确定的。</p>
<p>因为 Pulsar 客户端支持<a href="https://github.com/apache/pulsar/wiki/PIP-60:-Support-Proxy-server-with-SNI-routing">SNI 路由协议</a>，所以你可以通过 Pulsar Proxy连接到 实际的broker。 这篇文档会教你通过设置 ATS 代理，来启用 SNI 路由，使 Pulsar 客户端可以通过 ATS 代理连接到 broker中。</p>
<h3><a class="anchor" aria-hidden="true" id="pulsar-使用-ats-sni-路由"></a><a href="#pulsar-使用-ats-sni-路由" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pulsar 使用 ATS-SNI 路由</h3>
<p>如果要使用 ATS 支持<a href="https://docs.trafficserver.apache.org/en/latest/admin-guide/layer-4-routing.en.html">四层 SNI 路由</a>，客户端与 Pulsar Proxy 的连接必须是 TLS 连接。 Pulsar 客户端在 TLS 连接内支持 SNI 路由协议，所以当 Pulsar 客户端通过 ATS 代理连接到 broker的时候，Pulsar 实际是使用 ATS 作为一个反向代理。</p>
<p>Pulsar 的跨域复制功能是支持 SNI 路由的，所以不同集群的 Bokrer 之间能够通过 ATS 代理进行通信。</p>
<p>本节说明了如何设置和使用 ATS 作为反向代理， 使 Pulsar 客户端能够通过在 TLS 连接上使用 SNI 路由，以连接到实际的 broker。</p>
<h4><a class="anchor" aria-hidden="true" id="四层-sni-路由-启用-ats-代理"></a><a href="#四层-sni-路由-启用-ats-代理" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四层 SNI 路由 启用 ATS 代理</h4>
<p>如果需要支持四层 SNI 路由， 你必须修改<code>records.conf</code>和<code>ssl_server_name.conf</code>这两个配置文件。</p>
<p><img src="/docs/assets/pulsar-sni-client.png" alt="Pulsar client SNI"></p>
<p>默认情况下，<a href="https://docs.trafficserver.apache.org/en/latest/admin-guide/files/records.config.en.html">records.config</a>文件是在本地的<code>/usr/local/etc/trafficserver/</code>目录下的。 The file lists configurable variables used by the ATS.</p>
<p>To configure the <code>records.config</code> files, complete the following steps.</p>
<ol>
<li>Update TLS port (<code>http.server_ports</code>) on which proxy listens, and update proxy certs (<code>ssl.client.cert.path</code> and <code>ssl.client.cert.filename</code>) to secure TLS tunneling.</li>
<li>Configure server ports (<code>http.connect_ports</code>) used for tunneling to the broker. If Pulsar brokers are listening on <code>4443</code> and <code>6651</code> ports, add the brokers service port in the <code>http.connect_ports</code> configuration.</li>
</ol>
<p>The following is an example.</p>
<pre><code class="hljs"><span class="hljs-comment"># PROXY TLS PORT</span><span class="hljs-built_in">
CONFIG </span>proxy.config.http.server_ports STRING 4443:ssl 4080
<span class="hljs-comment"># PROXY CERTS FILE PATH</span><span class="hljs-built_in">
CONFIG </span>proxy.config.ssl.client.cert.path STRING /proxy-cert.pem
<span class="hljs-comment"># PROXY KEY FILE PATH</span><span class="hljs-built_in">
CONFIG </span>proxy.config.ssl.client.cert.filename STRING /proxy-key.pem


<span class="hljs-comment"># The range of origin server ports that can be used for tunneling via CONNECT. # Traffic Server allows tunnels only to the specified ports. Supports both wildcards (*) and ranges (e.g. 0-1023).</span><span class="hljs-built_in">
CONFIG </span>proxy.config.http.connect_ports STRING 4443 6651
</code></pre>
<p>The <a href="https://docs.trafficserver.apache.org/en/8.0.x/admin-guide/files/ssl_server_name.yaml.en.html">ssl_server_name</a> file is used to configure TLS connection handling for inbound and outbound connections. The configuration is determined by the SNI values provided by the inbound connection. The file consists of a set of configuration items, and each is identified by an SNI value (<code>fqdn</code>). When an inbound TLS connection is made, the SNI value from the TLS negotiation is matched with the items specified in this file. If the values match, the values specified in that item override the default values.</p>
<p>The following example shows mapping of the inbound SNI hostname coming from the client, and the actual broker service URL where request should be redirected. For example, if the client sends the SNI header <code>pulsar-broker1</code>, the proxy creates a TLS tunnel by redirecting request to the <code>pulsar-broker1:6651</code> service URL.</p>
<pre><code class="hljs">server_config = {
  {
     fqdn = <span class="hljs-string">'pulsar-broker-vip'</span>,
     # Forward <span class="hljs-keyword">to</span> Pulsar broker which <span class="hljs-keyword">is</span> listening <span class="hljs-keyword">on</span> <span class="hljs-number">6651</span>
     tunnel_route = <span class="hljs-string">'pulsar-broker-vip:6651'</span>
  },
  {
     fqdn = <span class="hljs-string">'pulsar-broker1'</span>,
     # Forward <span class="hljs-keyword">to</span> Pulsar broker<span class="hljs-number">-1</span> which <span class="hljs-keyword">is</span> listening <span class="hljs-keyword">on</span> <span class="hljs-number">6651</span>
     tunnel_route = <span class="hljs-string">'pulsar-broker1:6651'</span>
  },
  {
     fqdn = <span class="hljs-string">'pulsar-broker2'</span>,
     # Forward <span class="hljs-keyword">to</span> Pulsar broker<span class="hljs-number">-2</span> which <span class="hljs-keyword">is</span> listening <span class="hljs-keyword">on</span> <span class="hljs-number">6651</span>
     tunnel_route = <span class="hljs-string">'pulsar-broker2:6651'</span>
  },
}
</code></pre>
<p>After you configure the <code>ssl_server_name.config</code> and <code>records.config</code> files, the ATS-proxy server handles SNI routing and creates TCP tunnel between the client and the broker.</p>
<h4><a class="anchor" aria-hidden="true" id="configure-pulsar-client-with-sni-routing"></a><a href="#configure-pulsar-client-with-sni-routing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure Pulsar-client with SNI routing</h4>
<p>ATS SNI-routing works only with TLS. You need to enable TLS for the ATS proxy and brokers first, configure the SNI routing protocol, and then connect Pulsar clients to brokers through ATS proxy. Pulsar clients support SNI routing by connecting to the proxy, and sending the target broker URL to the SNI header. This process is processed internally. You only need to configure the following proxy configuration initially when you create a Pulsar client to use the SNI routing protocol.</p>
<pre><code class="hljs">String brokerServiceUrl = “pulsar+ssl:<span class="hljs-comment">//pulsar-broker-vip:6651/”;</span>
String proxyUrl = “pulsar+ssl:<span class="hljs-comment">//ats-proxy:443”;</span>
ClientBuilder clientBuilder = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">PulsarClient</span>.</span></span>builder<span class="hljs-literal">()</span>
        .service<span class="hljs-constructor">Url(<span class="hljs-params">brokerServiceUrl</span>)</span>
        .tls<span class="hljs-constructor">TrustCertsFilePath(TLS_TRUST_CERT_FILE_PATH)</span>
        .enable<span class="hljs-constructor">Tls(<span class="hljs-params">true</span>)</span>
        .allow<span class="hljs-constructor">TlsInsecureConnection(<span class="hljs-params">false</span>)</span>
        .proxy<span class="hljs-constructor">ServiceUrl(<span class="hljs-params">proxyUrl</span>, ProxyProtocol.SNI)</span>
        .operation<span class="hljs-constructor">Timeout(1000, TimeUnit.MILLISECONDS)</span>;

Map&lt;String, String&gt; authParams = <span class="hljs-keyword">new</span> HashMap&lt;&gt;<span class="hljs-literal">()</span>;
authParams.put(<span class="hljs-string">"tlsCertFile"</span>, TLS_CLIENT_CERT_FILE_PATH);
authParams.put(<span class="hljs-string">"tlsKeyFile"</span>, TLS_CLIENT_KEY_FILE_PATH);
clientBuilder.authentication(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AuthenticationTls</span>.</span></span><span class="hljs-keyword">class</span>.get<span class="hljs-constructor">Name()</span>, authParams);

PulsarClient pulsarClient = clientBuilder.build<span class="hljs-literal">()</span>;
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="pulsar-geo-replication-with-sni-routing"></a><a href="#pulsar-geo-replication-with-sni-routing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pulsar geo-replication with SNI routing</h4>
<p>You can use the ATS proxy for geo-replication. Pulsar brokers can connect to brokers in geo-replication by using SNI routing. To enable SNI routing for broker connection cross clusters, you need to configure SNI proxy URL to the cluster metadata. If you have configured SNI proxy URL in the cluster metadata, you can connect to broker cross clusters through the proxy over SNI routing.</p>
<p><img src="/docs/assets/pulsar-sni-geo.png" alt="Pulsar client SNI"></p>
<p>In this example, a Pulsar cluster is deployed into two separate regions, <code>us-west</code> and <code>us-east</code>. Both regions are configured with ATS proxy, and brokers in each region run behind the ATS proxy. We configure the cluster metadata for both clusters, so brokers in one cluster can use SNI routing and connect to brokers in other clusters through the ATS proxy.</p>
<p>(a) Configure the cluster metadata for <code>us-east</code> with <code>us-east</code> broker service URL and <code>us-east</code> ATS proxy URL with SNI proxy-protocol.</p>
<pre><code class="hljs"><span class="hljs-string">./pulsar-admin</span> clusters update \
<span class="hljs-params">--broker-url-secure</span> pulsar+ssl:<span class="hljs-string">//east-broker-vip</span><span class="hljs-function">:6651</span> \
<span class="hljs-params">--url</span> http:<span class="hljs-string">//east-broker-vip</span><span class="hljs-function">:8080</span> \
<span class="hljs-params">--proxy-protocol</span> SNI \
<span class="hljs-params">--proxy-url</span> pulsar+ssl:<span class="hljs-string">//east-ats-proxy</span><span class="hljs-function">:443</span>
</code></pre>
<p>(b) Configure the cluster metadata for <code>us-west</code> with <code>us-west</code> broker service URL and <code>us-west</code> ATS proxy URL with SNI proxy-protocol.</p>
<pre><code class="hljs"><span class="hljs-string">./pulsar-admin</span> clusters update \
<span class="hljs-params">--broker-url-secure</span> pulsar+ssl:<span class="hljs-string">//west-broker-vip</span><span class="hljs-function">:6651</span> \
<span class="hljs-params">--url</span> http:<span class="hljs-string">//west-broker-vip</span><span class="hljs-function">:8080</span> \
<span class="hljs-params">--proxy-protocol</span> SNI \
<span class="hljs-params">--proxy-url</span> pulsar+ssl:<span class="hljs-string">//west-ats-proxy</span><span class="hljs-function">:443</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#使用-sni-路由的-pulsar-proxy">使用 SNI 路由的 Pulsar Proxy</a><ul class="toc-headings"><li><a href="#pulsar-使用-ats-sni-路由">Pulsar 使用 ATS-SNI 路由</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</section><span><script>
      const community = document.querySelector("a[href='#community']").parentNode;
      const communityMenu =
        '<li>' +
        '<a id="community-menu" href="#">Community <span style="font-size: 0.75em">&nbsp;▼</span></a>' +
        '<div id="community-dropdown" class="hide">' +
          '<ul id="community-dropdown-items">' +
            '<li><a href="/zh-CN/contact">Contact</a></li>' +
            '<li><a href="/zh-CN/contributing">Contributing</a></li>' +
            '<li><a href="/zh-CN/coding-guide">Coding guide</a></li>' +
            '<li><a href="/zh-CN/events">Events</a></li>' +
            '<li><a href="https://twitter.com/Apache_Pulsar" target="_blank">Twitter &#x2750</a></li>' +
            '<li><a href="https://github.com/apache/pulsar/wiki" target="_blank">Wiki &#x2750</a></li>' +
            '<li><a href="https://github.com/apache/pulsar/issues" target="_blank">Issue tracking &#x2750</a></li>' +
            '<li><a href="https://pulsar-summit.org/" target="_blank">Pulsar Summit &#x2750</a></li>' +
            '<li>&nbsp;</li>' +
            '<li><a href="/zh-CN/resources">Resources</a></li>' +
            '<li><a href="/zh-CN/team">Team</a></li>' +
            '<li><a href="/zh-CN/powered-by">Powered By</a></li>' +
          '</ul>' +
        '</div>' +
        '</li>';

      community.innerHTML = communityMenu;

      const communityMenuItem = document.getElementById("community-menu");
      const communityDropDown = document.getElementById("community-dropdown");
      communityMenuItem.addEventListener("click", function(event) {
        event.preventDefault();

        if (communityDropDown.className == 'hide') {
          communityDropDown.className = 'visible';
        } else {
          communityDropDown.className = 'hide';
        }
      });
    </script></span></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'd226a455cecdd4bc18a554c1b47e5b52',
                indexName: 'apache_pulsar',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN","version:next"]}
              });
            </script></body></html>